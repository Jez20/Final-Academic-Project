/**
 * Author:  FV
 * Created: May 5, 2022
 */
CREATE SCHEMA UAAP_APPAREL;


CREATE TABLE PRODUCT_TABLE (PRODUCT_ID INTEGER PRIMARY KEY GENERATED ALWAYS AS IDENTITY(Start with 1, Increment by 1), 
PRODUCT_NAME VARCHAR(50) NOT NULL, 
PRODUCT_DESC VARCHAR(1000),
PRODUCT_SCHOOL VARCHAR(50) NOT NULL,
PRODUCT_CATEGORY VARCHAR(50) NOT NULL,
PRODUCT_GENDER VARCHAR(50) NOT NULL,
PRODUCT_SIZE VARCHAR(50) NOT NULL,
PRODUCT_PRICE INT NOT NULL,
PRODUCT_IMG_LINK VARCHAR(50) NOT NULL,
PRODUCT_STOCK INT NOT NULL
);

CREATE TABLE USER_TABLE(USER_ID INTEGER PRIMARY KEY GENERATED ALWAYS AS IDENTITY(Start with 1, Increment by 1),
USER_FNAME VARCHAR(45) NOT NULL,
USER_LNAME VARCHAR(45) NOT NULL,
USER_PASSWORD VARCHAR(1000) NOT NULL,
USER_ROLE VARCHAR(45) NOT NULL,
USER_EMAIL VARCHAR(100) NOT NULL
);

CREATE TABLE ORDER_TABLE (ORDER_ID INTEGER PRIMARY KEY GENERATED ALWAYS AS IDENTITY(Start with 1, Increment by 1),
PRODUCT_ID INTEGER NOT NULL REFERENCES PRODUCT_TABLE(PRODUCT_ID), 
USER_ID INTEGER NOT NULL REFERENCES USER_TABLE(USER_ID),
QUANTITY INTEGER NOT NULL,
ORDER_PRICE INTEGER NOT NULL,
ORDER_ISPENDING BOOLEAN NOT NULL,
ORDER_DATE DATE NOT NULL,
ORDER_COMPLETED DATE
);

SELECT * FROM PRODUCT_TABLE;
SELECT * FROM USER_TABLE;
SELECT * FROM ORDER_TABLE WHERE ORDER_ISPENDING=false ORDER BY ORDER_DATE asc;

SELECT COUNT(ORDER_ID) FROM ORDER_TABLE WHERE ORDER_ISPENDING = TRUE;

SELECT
 USER_TABLE.USER_ID, 
ORDER_TABLE.ORDER_ID,
ORDER_TABLE.PRODUCT_ID,
USER_TABLE.USER_FNAME, 
USER_TABLE.USER_ROLE, 
PRODUCT_TABLE.PRODUCT_NAME,
PRODUCT_TABLE.PRODUCT_PRICE,
ORDER_TABLE.QUANTITY,
ORDER_TABLE.ORDER_PRICE
 FROM USER_TABLE 
JOIN ORDER_TABLE ON USER_TABLE.USER_ID = ORDER_TABLE.USER_ID 
JOIN PRODUCT_TABLE ON PRODUCT_TABLE.PRODUCT_ID = ORDER_TABLE.PRODUCT_ID
ORDER BY USER_TABLE.USER_ID ASC;

DELETE FROM ORDER_TABLE;
DELETE FROM PRODUCT_TABLE;

-- a test whether the key constraints work
-- INSERT INTO APP.ORDER_TABLE (PRODUCT_ID, USER_ID, QUANTITY, ORDER_PRICE, ORDER_ISPENDING, ORDER_DATE, ORDER_COMPLETED) 
-- 	VALUES (22, 4, 9, 30114, true, '2022-01-29', CURRENT_DATE)

INSERT INTO APP.PRODUCT_TABLE (PRODUCT_NAME, PRODUCT_DESC, PRODUCT_SCHOOL, PRODUCT_CATEGORY, PRODUCT_GENDER, PRODUCT_SIZE, PRODUCT_PRICE, PRODUCT_IMG_LINK, PRODUCT_STOCK) 
	VALUES ('TEST PRODUCT', 'TEST DESC', 'FEU', 'Caps', 'F', 'XL', 50, 'TEST.COM', 50)



INSERT INTO APP.USER_TABLE (USER_FNAME, USER_LNAME, USER_PASSWORD, USER_ROLE, USER_EMAIL) 
	VALUES ('James', 'Cruz', '123', 'Customer', 'xd.gamil.om')
INSERT INTO APP.USER_TABLE (USER_FNAME, USER_LNAME, USER_PASSWORD, USER_ROLE, USER_EMAIL) 
	VALUES ('May', 'Mambog', '123', 'Admin', 'Hatdog.gmail.com')
INSERT INTO APP.USER_TABLE (USER_FNAME, USER_LNAME, USER_PASSWORD, USER_ROLE, USER_EMAIL) 
	VALUES ('Jared', 'Ruckel', '125', 'Customer', 'customer.gamil.com')


